<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Pathfinder Scenario Manager</title>
    <link rel="stylesheet" href="./HomePage-20181028-V1.css">
    <link href="https://fonts.googleapis.com/css?family=Niramit" rel="stylesheet">  
    <link rel="icon" type="image/png" href="./images/Gobelin.png" />

    <!-- update the version number as needed -->
    <script defer src="/__/firebase/6.2.4/firebase-app.js"></script>
    <!-- include only the Firebase features as you need -->
    <script defer src="/__/firebase/6.2.4/firebase-auth.js"></script>
    <!-- initialize the SDK after all desired features are loaded -->
    <script defer src="/__/firebase/init.js"></script>

    <style>
      body,h1,h2,h3,p,a{font-family: 'Niramit', sans-serif;}
      body, html {height: 100%}
      p {line-height: 2}
      .bgimg, .bgimg2 {
      min-height: 100%;
      background-position: center;
      background-size: cover;
      }
      .bgimg {background-image: url("./images/Mist-black.png")}
    </style>
  </head>
  
  
  <body>
    
    <!-- Header / Home-->
    
    <header class="w3-display-container w3-wide bgimg w3-grayscale-min" id="home">
      <div class="w3-display-middle w3-text-white w3-center">
	      <img src="./images/Gobelin.png" alt="Goblin" style="width:30%" class="w3-margin-top">
        <h1 class="w3-jumbo">Pathfinder Scenario Manager</h1>
        <h2>Ne perdez plus rien de vos parties...</h2>
	      <p class="w3-xlarge">
          <button onclick="document.getElementById('id01').style.display='block'" class="w3-button w3-round w3-amber w3-hover-opacity-off" style="padding:8px 60px">Connexion</button>
	        <button onclick="document.getElementById('id02').style.display='block'" class="w3-button w3-round w3-amber w3-hover-opacity-off" style="padding:8px 60px">Inscription</button>
        </p>
      </div>
    </header>


    <!-- Connexion pop-up -->
    <div id="id01" class="w3-modal">
      <div class="w3-modal-content w3-card-4 w3-animate-zoom" style="max-width:600px">

      <div class="w3-center"><br>
        <span onclick="document.getElementById('id01').style.display='none'" class="w3-button w3-xlarge w3-hover-red w3-display-topright" title="Close Modal">&times;</span>
        <img src="./images/avatar1.png" alt="Avatar" style="width:30%" class="w3-circle w3-margin-top">
      </div>

      <form id="login-form" class="w3-container" >
        <div class="w3-section">
          <label><b>Nom d'utilisateur</b></label>
          <input class="w3-input w3-border w3-margin-bottom" type="text" placeholder="Entrez votre nom d'utilisateur" name="usename-signin" id="username-signin" required>
          <label><b>Mot de passe</b></label>
          <input class="w3-input w3-border" type="password" placeholder="Entrez votre mot de passe" name="psw-signin" id="psw-signin" required>
          <button class="w3-button w3-block w3-amber w3-section w3-padding" type="submit">Connexion</button>
          <input class="w3-check w3-margin-top" type="checkbox" checked="checked"> Se souvenir de moi
        </div>
      </form>

       <div class="w3-container w3-border-top w3-padding-16 w3-light-grey">
        <button onclick="document.getElementById('id01').style.display='none'" type="button" class="w3-button w3-red">Annuler</button>
        <span class="w3-right w3-padding w3-hide-small"><a href="#">Mot de passe oublié ?</a></span>
       </div>

      </div>
    </div>


	
    <!-- Inscription pop-up -->
    <div id="id02" class="w3-modal">
      
      <div class="w3-modal-content w3-card-4 w3-animate-zoom" style="max-width:600px">
  		<div class="w3-center"><br>
			  <span onclick="document.getElementById('id02').style.display='none'" class="w3-button w3-xlarge w3-hover-red w3-display-topright" title="Close Modal">&times;</span>
			  <h1>Inscription</h1>
			  <p>Complétez le formulaire pour créer votre compte CCC.</p>
		  </div>

			<form id="registration-form" class="w3-container">
			 	<div class="w3-section">

					<label><b>Nom d'utilisateur</b></label>
					<input class="w3-input w3-border w3-margin-bottom" type="text" placeholder="Choisissez un nom d'utilisateur" id="username-inscription" name="username-inscription" required>

					<label><b>E-mail</b></label>
					<input class="w3-input w3-border w3-margin-bottom"  type="text" placeholder="Entrez votre adresse e-mail" id="email-inscription" name="email-inscription" required>

					<label><b>Mot de passe</b></label>
					<input class="w3-input w3-border w3-margin-bottom"  type="password" placeholder="Entrez un mot de passe" id="pwd-inscription" name="psw"-inscription required>

					<label><b>Repeat Password</b></label>
					<input class="w3-input w3-border w3-margin-bottom"  type="password" placeholder="Répétez le mot de passe" id="pwd-repeat"name="psw-repeat" required>

					 <p>En cliquant sur s'inscrire, vous acceptez les <a href="#" style="color:dodgerblue">Conditions d'utilisation</a>.</p>

					<button class="w3-button w3-block w3-amber w3-section w3-padding" type="submit">S'inscrire</button>
					<input type="checkbox" checked="checked" name="remember" style="margin-bottom:15px"> Se souvenir de moi

				</div>
		 	</form>

		  <div class="w3-container w3-border-top w3-padding-16 w3-light-grey">
			  <button onclick="document.getElementById('id02').style.display='none'" type="button" class="w3-button w3-red">Annuler</button>
			  <span class="w3-right w3-padding w3-hide-small"><a href="#">Déjà membre, connectez-vous.</a></span>
		  </div>

      </div>
    </div>
	

	<!-- SCRIPTS -->
    
<!-- Pop ups -->
<script>
// Get the modal
	var modal = document.getElementById('id01');
	var modal2 = document.getElementById('id02');
// When the user clicks anywhere outside of the modal, close it
window.onclick = function(event) {
    if (event.target == modal) {
        modal.style.display = "none";
    }
	if (event.target == modal2) {
		modal2.style.display = "none";
	}
}
</script>
      
      
      
      
      
  
    <!-- Connexion -->
    


      
      
      
<script>
document.getElementById('login-form').addEventListener('submit', function(e) {
  // prevent default browser behavior
    e.preventDefault();
    console.log("in the listener");
  // find the username and password nodes
    var username_element = e.srcElement.elements.username;
    var password_element = e.srcElement.elements.psw;
    
    var i;
     for(i=0;i<userDatabase.length;++i)
     {
        if(userDatabase[i].NOM == username_element.value){
            if(userDatabase[i].MDP == password_element.value){   
                alert('Connecté en tant que ' + username_element.value + '.');
                window.location.replace("./DashboardHistoireV1.html");
                localStorage.setItem('userToPass', username_element.value );
                break;
            }else{
                alert('NON, mauvais pour ' + username_element.value + '.');
            }
         }else{
              continue;
         }
     }
    
})
    
</script>
      

	

    <!-- Inscription --> 
<script>
 document.getElementById('registration-form').addEventListener('submit', function(e) {
    // prevent default browser behavior
    e.preventDefault();
    console.log("in the registration form listener");
    var username = document.getElementById('username-inscription').value 
    var email = document.getElementById('email-inscription').value;
    var password = document.getElementById('pwd-inscription').value;
    var passwordcheck = document.getElementById('pwd-repeat').value;
    if (email.length < 4) {
        alert('Please enter an email address.');
        return;
      }
    if (password.length < 4) {
        alert('Please enter a password.');
        return;
      }
    if (password != passwordcheck) {
        alert('Please enter a password that match the two password fields.');
        return;
      }
     console.log("User value cached : Name = " + username +", email = " + email + ", Password = " + password); 
      // Sign in with email and pass.
      // [START createwithemail]
    firebase.auth().createUserWithEmailAndPassword(email, password).catch(function(error) {
        // Handle Errors here.
        var errorCode = error.code;
        var errorMessage = error.message;
        // [START_EXCLUDE]
        if (errorCode == 'auth/weak-password') {
          alert('The password is too weak.');
        } else {
          alert(errorMessage);
        }
        console.log(error);
        // [END_EXCLUDE]
      });
      // [END createwithemail]
     
     firebase.auth().onAuthStateChanged(function(user) {
      console.log("User data available in stateCnage function : Name = " + username +", email = " + email); 
      if (user) {
        console.log("user is signed in")
        user.updateProfile({
        displayName: username
             //,
          //photoURL: "https://example.com/jane-q-user/profile.jpg"
         }).then(function() {
            console.log("User create with : Name = " + username +", email = " + email); 
         }).catch(function(error) {
          console.log("error creating user : " + error);
         });
          
      } else {
        console.log("user is NOT signed in")
      }
    })
     
     /*

     user.updateProfile({
      displayName: username
         //,
      //photoURL: "https://example.com/jane-q-user/profile.jpg"
     }).then(function() {
        console.log("User create with : Name = " + username +"email = " + email); 
     }).catch(function(error) {
      console.log("error creating user : " + error);
     });
     */

 })
      
</script>

    
    
    
  </body>
</html>
